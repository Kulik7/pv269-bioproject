<tool id="metaMDBG_gfa" name="metaMDBG GFA" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@"
    profile="21.05">
    <description>Generate GFA graph(s) from metaMDBG assembly output</description>

    <macros>
        <token name="@TOOL_VERSION@">1.0</token>
        <token name="@VERSION_SUFFIX@">0</token>
    </macros>

    <requirements>
        <requirement type="package" version="@TOOL_VERSION@">metaMDBG</requirement>
    </requirements>

    <command detect_errors="exit_code"><![CDATA[
        metaMDBG gfa --assembly-dir $contigs --k $k_value
    ]]></command>

    <inputs>
        <param name="contigs" type="data" format="fasta.gz" label="Contigs file" />
        <param name="k_values" type="data" format="txt" label="k-values file" />

        <param name="k_value" type="select" label="Select k-mer value">
            <options from_dataset="k_values">
                <column name="value" index="0" />
                <column name="name" index="0" />
            </options>
        </param>

    </inputs>

    <outputs>
        <data name="output_gfa" format="txt" label="GFA output" />
    </outputs>

    <tests>
        <test expect_num_outputs="1">
            <param name="contigs" value="contigs.fasta.gz" />
            <param name="k_values" value="test_k_values.txt" />
            <param name="k_value" value="21" />

            <output name="output_gfa" value="assemblyGraph_k21_4013bps.gfa" compare="sim_size"
                delta="100" delta_frac="0.05">
            </output>
        </test>
    </tests>

    <help><![CDATA[ 

Program: metaMDBG (assembly of long metagenomics reads)
Version: 1.1
Contact: GaÃ«tan Benoit (gaetanbenoitdev@gmail.com)

Usage: metaMDBG [command]

command:
        gfa: generate an assembly graph (.gfa). Require a finished metaMDBG run


    ]]></help>

    <citations>
        <citation type="doi">10.1038/s41587-023-01983-6</citation>
    </citations>
</tool>